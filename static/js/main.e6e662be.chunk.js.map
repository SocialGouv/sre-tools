{"version":3,"sources":["Form.js","useQueryParams.js","certificates.js","App.js","index.js"],"names":["keyValidator","RadioChoice","React","forwardRef","ref","name","value","props","Check","inline","id","label","type","keepValidQueryParamKeys","key","includes","object","Object","keys","filter","reduce","acc","Form","onSubmit","initialFormData","urlParams","parse","window","location","search","useState","innerData","setInnerData","useCallback","data","history","replaceState","title","document","href","split","stringify","useQueryParams","queryParamsData","setQueryParamsData","queryParams","defaultValues","scope","cluster","useForm","mode","register","handleSubmit","watch","setValue","trigger","getValues","_onSubmit","useEffect","subscription","values","unsubscribe","Row","Col","xs","md","sm","Label","onChange","e","target","undefined","style","display","disabled","Group","as","column","Control","required","placeholder","marginTop","rows","certificates","dev","prod","Intro","Jumbotron","padding","CodeArea","fontSize","fontFamily","border","width","height","Copier","text","copied","setCopied","onCopy","setTimeout","marginLeft","cursor","transition","color","size","Editor","namespace","formData","setFormData","encrypted","setEncrypted","yamlResult","setYamlResult","a","pemKey","match","forEach","row","matches","VALUE","getSealedSecret","sealedSecret","length","spec","encryptedData","yaml","dump","noRefs","lineWidth","console","log","Container","Card","Body","Title","defaultValue","App","className","rootElement","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.e6e662be.chunk.js","sourcesContent":["import React from \"react\";\n\nimport { Row, Col, Form as BsForm, Button } from \"react-bootstrap\";\nimport { useForm } from \"react-hook-form\";\nimport { useQueryParams } from \"./useQueryParams\";\n\nconst RadioChoice = React.forwardRef(({ name, value, ...props }, ref) => (\n  <BsForm.Check\n    inline\n    ref={ref}\n    name={name}\n    id={`${name}-${value}`}\n    label={value}\n    type=\"radio\"\n    value={value}\n    {...props}\n  />\n));\n\nconst isValidQueryParamsKey = (key) =>\n  [\"namespace\", \"scope\", \"cluster\", \"name\"].includes(key);\n\nconst removeInvalidKeys = (keyValidator) => (object) =>\n  Object.keys(object)\n    .filter(keyValidator)\n    .reduce(\n      (acc, key) => ({\n        ...acc,\n        [key]: object[key],\n      }),\n      {}\n    );\n\nconst keepValidQueryParamKeys = removeInvalidKeys(isValidQueryParamsKey);\n\nexport const Form = ({ onSubmit, initialFormData }) => {\n  const [queryParamsData, setQueryParamsData] = useQueryParams();\n\n  const queryParams = keepValidQueryParamKeys(queryParamsData);\n\n  const defaultValues = {\n    ...initialFormData,\n    ...queryParams,\n    scope: queryParams.cluster === \"prod\" ? \"strict\" : \"cluster\",\n  };\n\n  const { register, handleSubmit, watch, setValue, trigger, getValues } =\n    useForm({\n      mode: \"onChange\",\n      defaultValues,\n    });\n\n  const _onSubmit = (data) => {\n    setQueryParamsData(keepValidQueryParamKeys(data));\n    onSubmit(data);\n    //console.log(\"submit\", data);\n  };\n\n  const cluster = watch(\"cluster\");\n  const scope = watch(\"scope\");\n  const value = watch(\"value\");\n\n  React.useEffect(() => {\n    const subscription = watch(\n      (\"value\",\n      ({ name, type }) => {\n        const values = getValues();\n        _onSubmit(values);\n      })\n    );\n    return () => subscription.unsubscribe();\n  }, [watch]);\n\n  React.useEffect(() => {\n    const subscription = watch(\n      (\"cluster\",\n      ({ name, type }) => {\n        const values = getValues();\n        _onSubmit(values);\n      })\n    );\n    return () => subscription.unsubscribe();\n  }, [watch]);\n\n  return (\n    <BsForm onSubmit={handleSubmit(_onSubmit)}>\n      <Row>\n        <Col xs={12} md={6}>\n          <Row>\n            <Col sm=\"3\">\n              <BsForm.Label>Cluster</BsForm.Label>\n            </Col>\n            <Col sm=\"9\">\n              <RadioChoice\n                name=\"cluster\"\n                value=\"dev\"\n                label=\"dev / preprod\"\n                {...register(\"cluster\")}\n                onChange={(e) => {\n                  setValue(\"cluster\", e.target.value);\n                  setValue(\"scope\", \"cluster\");\n                  setValue(\"namespace\", undefined);\n                  setValue(\"name\", undefined);\n                  trigger();\n                }}\n              />\n              <RadioChoice\n                name=\"cluster\"\n                value=\"prod\"\n                {...register(\"cluster\")}\n                onChange={(e) => {\n                  setValue(\"cluster\", e.target.value);\n                  setValue(\"scope\", \"strict\");\n                  trigger();\n                }}\n              />\n            </Col>\n          </Row>\n        </Col>\n        <Col style={{ display: \"none\" }}>\n          <Row>\n            <Col xs={12} sm={3}>\n              <BsForm.Label>Scope</BsForm.Label>\n            </Col>\n            <Col sm={9}>\n              <RadioChoice\n                name=\"scope\"\n                value=\"cluster\"\n                disabled={cluster === \"prod\"}\n                {...register(\"scope\")}\n                onChange={(e) => {\n                  setValue(\"scope\", e.target.value);\n                  trigger();\n                }}\n              />\n              <RadioChoice\n                name=\"scope\"\n                value=\"namespace\"\n                disabled={cluster === \"prod\"}\n                {...register(\"scope\")}\n                onChange={(e) => {\n                  setValue(\"scope\", e.target.value);\n                  trigger();\n                }}\n              />\n              <RadioChoice\n                name=\"scope\"\n                value=\"strict\"\n                {...register(\"scope\")}\n                onChange={(e) => {\n                  setValue(\"scope\", e.target.value);\n                  trigger();\n                }}\n              />\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n      {(scope === \"namespace\" || scope === \"strict\") && (\n        <BsForm.Group as={Row}>\n          <BsForm.Label column>Namespace</BsForm.Label>\n          <Col sm=\"9\">\n            <BsForm.Control\n              name=\"namespace\"\n              {...register(\"namespace\", { required: true })}\n              required\n              type=\"text\"\n              placeholder=\"K8s Namespace\"\n            />\n          </Col>\n        </BsForm.Group>\n      )}\n      {scope === \"strict\" && (\n        <BsForm.Group as={Row}>\n          <BsForm.Label column>Secret name</BsForm.Label>\n          <Col sm=\"9\">\n            <BsForm.Control\n              name=\"name\"\n              {...register(\"name\", { required: true })}\n              type=\"text\"\n              placeholder=\"K8s secret name\"\n            />\n          </Col>\n        </BsForm.Group>\n      )}\n      <BsForm.Group>\n        <BsForm.Control\n          as=\"textarea\"\n          name=\"value\"\n          id=\"value\"\n          style={{ marginTop: 10 }}\n          rows={8}\n          {...register(\"value\", { required: true, value })}\n          placeholder={`MY_TOKEN=SomeSuperSecretToken\nMY_PASSWORD=SomeSuperSecretPassword`}\n        />\n      </BsForm.Group>\n    </BsForm>\n  );\n};\n","import { parse, stringify } from \"query-string\";\nimport { useCallback, useState } from \"react\";\n\nexport const useQueryParams = () => {\n  const urlParams = parse(window.location.search);\n\n  const [innerData, setInnerData] = useState(urlParams);\n\n  const setData = useCallback(\n    (data) => {\n      // dont reload page\n      window.history.replaceState(\n        {},\n        window.title,\n        document.location.href.split(\"?\")[0] + \"?\" + stringify(data)\n      );\n      setInnerData(data);\n    },\n    [setInnerData]\n  );\n\n  return [innerData, setData];\n};\n","\n// https://kubeseal.dev2.fabrique.social.gouv.fr/v1/cert.pem\nexport const dev = `-----BEGIN CERTIFICATE-----\nMIIErjCCApagAwIBAgIRAOqAV9ZpCl1cwMunTHirqXwwDQYJKoZIhvcNAQELBQAw\nADAeFw0yMDA1MjYwODQxMTBaFw0zMDA1MjQwODQxMTBaMAAwggIiMA0GCSqGSIb3\nDQEBAQUAA4ICDwAwggIKAoICAQDc5wz/el5+ghmNAsQzpFK3jtLRIDcoYgyeGHaG\nLH/FCuatiE3qhFeJt2uYQ+GFmEg3e9N/6xDY8NgUMvLdUlAfl5TqV5H96EXTSsGE\naRL2K4EIIdmFflas+r7dh5IYtmV8NTXW2ESLkyOe3PufK/OhdD/xcxglYLM+JnR2\npbKqFvFcsk+LHK3FTWt0xSeqgd+6G9PIxUAbHtoKYI9R41rWnCXY7n0zp+zWD/6j\nEDsbCgFJ657Zwwn0XXGkQqItdZsN+ETIcBVIdqemzcksd7RRUZQiJF8imM5S/wj/\n1o55JwAPLqg5Odj5T/pQq4gSG+UG1P0eJxBQpUCgmtW1SAjS2Gv9kkuw/PAMmLAa\nN0uHnM8TY9OPLLMENjmn9IhvYrhj5lKff4NXNC4nHFSDUAVfu5kNHrYn9WnCCw/f\nZE81p5Do7IcsbfmgEq3Ttg7p1eqXpH9NE9TWSZTz3HW/0lmEuIsNxjX/692DBeP/\nCCUiYlAef704Woo84jwIz4jEwfjonsFVaHbbtIGyqjvTlWcYfQnCLvnB+Plqutc/\n/p8/ViXXfuAwj/K3lYvhGWt2TNLo963XG/pqBVbZxYVI4m7IzrZ0vhbhck1oGYN8\nyX8sYPBUn5/5X/bJ8Xz1KsAeCfSXAvCjAZ3MfQDwxbsEURVQAeiDcF61G75/Lq/Z\nBm74hwIDAQABoyMwITAOBgNVHQ8BAf8EBAMCAAEwDwYDVR0TAQH/BAUwAwEB/zAN\nBgkqhkiG9w0BAQsFAAOCAgEAKLvQtDV5QVNUEcg3ywL03IwtNWmU8EqqASgckVAc\ndmeGnFwV7+7VnrIHI34xCZDhAVEnlMAb0oELgTDSstTx4p25rjqOLQfPcb0TsPko\ncpJHS00trLsLX4DYoZ1dLprgySGrC9jQ/FMYMK1oZ0M04gA/U9alNVNu2DWKosHu\nJGRYBbXVnse5rZi3hl4GV5Vq2ZR/3GHL9xgcjMcSLqHhXoSULLm5qEBUA5flV0BJ\nbY2FEfpm1NHSh5vOaA5t7lrW/XqiAuo8lJM2Ztg/dsX6Zxq7Memq8nqMRpoMFbdj\ni0jTxlPL1ssVHvvmWcLsdx9fHX7XaNGZ4ulA6BIL4DZQMPxvtFk9alqbc9WnjsqL\n/8QA3STXkTSzWrSsTUcabxlp5+MLHRf31iE1dlGVv7FVLjPy29T145eSzoNPM9sN\n1+aBLnXDCj5HUwto8+iKJn7VTURty5KceUFSeURXM2IKYYTec8MElLX0PeXi+SvO\nW37ZCn0RMnljus5aTUPbRHNvJ3Ut/1WDLQu8X0wIm509F1A80Udg5FTxHasBizM2\nL+rpr2923MG1JSitDfvNj1rxx1FLdynP84SOEJDCtbB8YRcDUC4bHKrAcG4FBAFX\nUDzbbsoR58onjcZW3QH4mvV9K3+llwHSo8zfYyKRhF8pUUJHp7A/8DgMYQyYAv2z\nbag=\n-----END CERTIFICATE-----`;\n\n// https://kubeseal.prod2.fabrique.social.gouv.fr/v1/cert.pem\nexport const prod = `-----BEGIN CERTIFICATE-----\nMIIErTCCApWgAwIBAgIQXJCfJIfF/fpww3KcvD0j1TANBgkqhkiG9w0BAQsFADAA\nMB4XDTIwMDUyNjA4NDkyN1oXDTMwMDUyNDA4NDkyN1owADCCAiIwDQYJKoZIhvcN\nAQEBBQADggIPADCCAgoCggIBAK8tTm78wfObpDaAa00eli9TwZfjbSO+Bis6DqNX\nto+tddnEBuEmnOlTKKoODZwnuph/G8JELKwbaTJ1bdYKasKDdgYju52ZMjBNexs4\nOX1L+YLiJEkwYBSkmYR/ARAulXIAolozjvub888OdWWOuZfX3DeNh/AI24uc+nrw\nsiKMyRZSsW9OXhRpBFe1BY8xofvnf1Ts5+OZWeNEmTbAKROKDd3rJpaKzxsJJwQ+\nSmRUQnxmwNxOfjFFxJx6n1jRloqwpLTOkCX/iSp6Nhnprcs8dvFjSH7l+gQU8XVY\nVXRWfXdJ6hBZd6fOjhKxlIrPz5+mUsMhyzON3ZS83XG9imFrWgSh3nBCifZRs4YF\nwxtGL1Qwm6CM+OsjLHM4lo6hrh9eEZVO8TwrXWKDU1CKkBgXVA5irGJ7NbGKtzih\nBZMRZ5pqQQ6ptiLXxfiB6DgvIJqvL8+yrt22j/QFZtyKkVW02n+dNiI7ltxb9RdS\nhyv3wBbHORgw6DbPrpoRpabDfUDEGJnd7+gY0Z5P9wHeX1vtt4g+XR5z/ERWIkFR\nuK2cLpflhGv4zE5DkI/2Pp4EAsQirUPlbdelvEz6NPtJk6ws5gQgBorRPaDhZojz\ntcYkFzRv3gkNHCMCMEAPEgU1OdUqslJVwi9P+/cxe9Piwwd9WWTu7mg6OB0cjhPI\ntYzhAgMBAAGjIzAhMA4GA1UdDwEB/wQEAwIAATAPBgNVHRMBAf8EBTADAQH/MA0G\nCSqGSIb3DQEBCwUAA4ICAQAjGgAz92xGNjbcIxsn2B/URYTBcsKd9RcgmzB3kDWq\nEKUV3KbgAItq4c2WB9bc0IG1Icp9bYOXZy1ldPoGib4edMUZuOU4xUAFVCrALGbk\ng8ldoEuIiSGAjQDuvWxl6XK8/FcBK93tR591zuJHS2KXspnV3FWi1tE8lr2zEd+G\nwuFzm0/uAyg+A+SEZVGwSBSH0fMWcCEk+yGyb4zmM3VW8D5zQvbialiqdmycZWoi\nC7Ldto5dBeFCCL7ndh1U0//UqaDmRCLazSeU6wCilWT4RvejBwNcojIYd0wk9keS\n8z92wpKj5Hv+OPn1r4fAmMnc3ObwtkVnka+QvuhKZOXmNInJSqdsZFToS6TaQOO6\n/W/urXYlcILJPlbTMlpjzxYVCi93yMcSrrdZ3MADlPhgtN+clVIRSQ/7eIDkh7j9\n9C+Dsz9nKa7FBSngDheJEEPcG2jNeRvO9kM2hgkMfcNdmTZUNyE19p1bdnTFoWCs\nq22fGvXZi6kkZTMDcSYDBZ8OkWK20GuZAs1mxrz9HfMdZobH7yNOj7Oj+0bNf5Ef\ntN6We84bWM+Xh7wlZxXPHpos5JDC5PV1Kmbwf3riLtTVe2W7hy+oKULS+WO59KJz\niKzeAM8CuUQixJtSmrNjp1nAsSR6/BZXWRvmZShksQ4kwFm/PlsWLEKgtzxtP0tN\nfg==\n-----END CERTIFICATE-----`;\n\nexport const certificates = {\n  dev,\n  prod,\n};\n","import React, { useState } from \"react\";\nimport { Card, Jumbotron, Container, Row, Col } from \"react-bootstrap\";\nimport { getSealedSecret } from \"@socialgouv/aes-gcm-rsa-oaep\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport { Clipboard } from \"react-feather\";\nimport yaml from \"js-yaml\";\n\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nimport { Form } from \"./Form\";\nimport { certificates } from \"./certificates.js\";\n\nconst Intro = () => (\n  <Jumbotron style={{ padding: \"2rem 1rem\" }}>\n    <h1>WebSeal</h1>\n    <p>Client-side sealed-secrets generation</p>\n  </Jumbotron>\n);\n\nconst CodeArea = (props) => (\n  <textarea\n    {...props}\n    style={{\n      fontSize: \"0.8rem\",\n      fontFamily: \"Courier\",\n      border: \"1px solid #ccc\",\n      width: \"100%\",\n      padding: 5,\n      height: 400,\n      ...(props.style || {}),\n    }}\n  ></textarea>\n);\n\nconst Copier = ({ text }) => {\n  const [copied, setCopied] = useState(false);\n  return (\n    <CopyToClipboard\n      text={text}\n      onCopy={() => {\n        setCopied(true);\n        setTimeout(() => setCopied(false), 2000);\n      }}\n    >\n      <Clipboard\n        style={{\n          marginLeft: 10,\n          cursor: \"pointer\",\n          transition: \"all 0.2s ease-in\",\n        }}\n        color={copied ? \"green\" : \"black\"}\n        title=\"Copy\"\n        size={16}\n      />\n    </CopyToClipboard>\n  );\n};\n\nconst Editor = () => {\n  const [formData, setFormData] = useState({\n    cluster: \"dev\",\n    value: \"\",\n    namespace: \"\",\n    name: \"\",\n  });\n  const [encrypted, setEncrypted] = useState(null);\n  const [yamlResult, setYamlResult] = useState(null);\n  const onSubmit = async (data) => {\n    //console.log(\"onSubmit\", data);\n    setFormData(data);\n    setYamlResult(\"\");\n    setEncrypted(\"\");\n    if (data.value && data.value !== formData.value) {\n      const pemKey = certificates[data.cluster];\n      const values = {};\n      if (data.value.match(/^([\\w_-\\d]+)=(.+)$/im)) {\n        data.value.split(\"\\n\").forEach((row) => {\n          const matches = row.match(/^([\\w_-\\d]+)=(.*)$/i);\n          if (matches) {\n            values[matches[1]] = matches[2];\n          }\n        });\n      } else {\n        values.VALUE = data.value;\n      }\n      const sealedSecret = await getSealedSecret({\n        pemKey,\n        namespace: data.namespace || null,\n        name: data.name || \"some-secret-name\",\n        scope: data.scope,\n        values,\n      });\n      if (data.scope === \"strict\" && (!data.namespace || !data.name)) {\n        console.log(\"namespace and name are mandatory\");\n        setYamlResult(\"\");\n        setEncrypted(\"\");\n      } else if (!data.value) {\n        console.log(\"value is mandatory\");\n        setYamlResult(\"\");\n        setEncrypted(\"\");\n      } else {\n        const keys = Object.keys(values);\n        if (keys.length === 1) {\n          setEncrypted(sealedSecret.spec.encryptedData[keys[0]]);\n        } else {\n          setEncrypted(\n            \"Not available for multiple values, use the below secret\"\n          );\n        }\n        setYamlResult(yaml.dump(sealedSecret, { noRefs: true, lineWidth: -1 }));\n      }\n    }\n  };\n  return (\n    <Container>\n      <Intro />\n      <Row>\n        <Col xs={12}>\n          <Form onSubmit={onSubmit} initialFormData={formData} />\n\n          {\n            <>\n              <Card style={{ marginTop: 10 }}>\n                <Card.Body>\n                  <Card.Title>\n                    Encrypted <Copier text={encrypted} />\n                  </Card.Title>\n                  <CodeArea defaultValue={encrypted} style={{ height: 200 }} />\n                </Card.Body>\n              </Card>\n              <Card style={{ marginTop: 10 }}>\n                <Card.Body>\n                  <Card.Title>\n                    SealedSecret <Copier text={yamlResult} />\n                  </Card.Title>\n                  <CodeArea defaultValue={yamlResult} />\n                </Card.Body>\n              </Card>\n            </>\n          }\n        </Col>\n      </Row>\n    </Container>\n  );\n};\n\nexport default function App() {\n  return (\n    <div className=\"App\">\n      <Editor />\n    </div>\n  );\n}\n","import { StrictMode } from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}